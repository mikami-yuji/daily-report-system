(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let s=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>s],55436)},88754,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(9165),r=e.i(75254);let l=(0,r.default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),d=(0,r.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),o=(0,r.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);function i({data:e,sortField:t,sortDirection:a,onSort:r}){let i=e=>null==e?"-":new Intl.NumberFormat("ja-JP").format(e),n=({field:e})=>t!==e?(0,s.jsx)(l,{size:14,className:"ml-1 text-gray-400 opacity-50"}):"desc"===a?(0,s.jsx)(o,{size:14,className:"ml-1 text-sf-light-blue"}):(0,s.jsx)(d,{size:14,className:"ml-1 text-sf-light-blue"}),c=({field:e,label:t,align:a="left"})=>(0,s.jsx)("th",{className:`px-4 py-3 font-medium text-xs text-sf-text-weak cursor-pointer hover:bg-gray-100 transition-colors select-none text-${a}`,onClick:()=>r(e),children:(0,s.jsxs)("div",{className:`flex items-center ${"right"===a?"justify-end":"center"===a?"justify-center":"justify-start"}`,children:[t,(0,s.jsx)(n,{field:e})]})});return(0,s.jsxs)("div",{className:"bg-white rounded-lg border border-sf-border shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-gray-50 border-b border-sf-border",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)(c,{field:"rank",label:"順位",align:"center"}),(0,s.jsx)(c,{field:"rank_class",label:"ランク",align:"center"}),(0,s.jsx)(c,{field:"customer_code",label:"CD"}),(0,s.jsx)(c,{field:"customer_name",label:"得意先名"}),(0,s.jsx)(c,{field:"area",label:"エリア"}),(0,s.jsx)(c,{field:"sales_amount",label:"売上金額",align:"right"}),(0,s.jsx)(c,{field:"gross_profit",label:"粗利金額",align:"right"}),(0,s.jsx)(c,{field:"sales_yoy",label:"前年比",align:"right"}),(0,s.jsx)(c,{field:"sales_last_year",label:"前年売上",align:"right"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-100",children:e.map((e,t)=>{var a;return(0,s.jsxs)("tr",{className:"hover:bg-blue-50/30 transition-colors",children:[(0,s.jsx)("td",{className:"px-4 py-3 text-center text-sf-text-weak font-mono",children:e.rank}),(0,s.jsx)("td",{className:"px-4 py-3 text-center",children:(0,s.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium 
                                        ${"A"===e.rank_class?"bg-orange-100 text-orange-800":"B"===e.rank_class?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:e.rank_class})}),(0,s.jsx)("td",{className:"px-4 py-3 font-mono text-xs text-sf-text-weak",children:e.customer_code}),(0,s.jsx)("td",{className:"px-4 py-3 font-medium text-sf-text",children:e.customer_name}),(0,s.jsx)("td",{className:"px-4 py-3 text-sf-text",children:e.area||"-"}),(0,s.jsx)("td",{className:"px-4 py-3 text-right font-mono font-medium text-sf-text",children:i(e.sales_amount)}),(0,s.jsx)("td",{className:"px-4 py-3 text-right font-mono text-sf-text-weak",children:i(e.gross_profit)}),(0,s.jsx)("td",{className:"px-4 py-3 text-right font-mono font-medium",children:e.sales_yoy?(0,s.jsx)("span",{className:`${e.sales_yoy>=105?"text-green-600 bg-green-50 px-1.5 py-0.5 rounded":e.sales_yoy<95?"text-red-500 bg-red-50 px-1.5 py-0.5 rounded":"text-sf-text"}`,children:null==(a=e.sales_yoy)?"-":`${a.toFixed(1)}%`}):"-"}),(0,s.jsx)("td",{className:"px-4 py-3 text-right font-mono text-xs text-sf-text-weak",children:i(e.sales_last_year)})]},`${e.customer_code}-${t}`)})})]})}),0===e.length&&(0,s.jsx)("div",{className:"p-12 text-center text-gray-400",children:"データが見つかりません"})]})}var n=e.i(55436);let c=(0,r.default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function x(){let[e,r]=(0,t.useState)([]),[l,d]=(0,t.useState)(!0),[o,x]=(0,t.useState)(""),[m,u]=(0,t.useState)("sales_amount"),[h,f]=(0,t.useState)("desc");(0,t.useEffect)(()=>{g()},[]);let g=async()=>{d(!0),r((await (0,a.getAllSales)()).map(e=>({...e,area:(e=>{if(!e)return;let s=e.match(/^.*?[都道府県]/);return s?s[0]:e})(e.area)}))),d(!1)},[p,b]=(0,t.useState)("all"),[j,y]=(0,t.useState)("all"),v=(0,t.useMemo)(()=>Array.from(new Set(e.map(e=>e.rank_class).filter(Boolean))).sort(),[e]),N=(0,t.useMemo)(()=>Array.from(new Set(e.map(e=>e.area).filter(e=>e&&"null"!==e&&"None"!==e))).sort(),[e]),w=(0,t.useMemo)(()=>{if(!Array.isArray(e))return[];let s=[...e];if("all"!==p&&(s=s.filter(e=>e.rank_class===p)),"all"!==j&&(s=s.filter(e=>e.area===j)),o){let e=o.toLowerCase();s=s.filter(s=>s.customer_name&&s.customer_name.toLowerCase().includes(e)||s.customer_code&&s.customer_code.toLowerCase().includes(e))}return s.sort((e,s)=>{let t=e[m],a=s[m];return null==t?1:null==a?-1:t<a?"asc"===h?-1:1:t>a?"asc"===h?1:-1:0}),s},[e,o,m,h,p,j]),_=(0,t.useMemo)(()=>{let e=w.reduce((e,s)=>e+(s.sales_amount||0),0),s=w.reduce((e,s)=>e+(s.gross_profit||0),0),t=w.reduce((e,s)=>e+(s.sales_last_year||0),0),a=w.reduce((e,s)=>e+(s.profit_last_year||0),0);return{sales:e,profit:s,salesLastYear:t,profitLastYear:a,salesYoY:t>0?(e-t)/t*100:0,profitYoY:a>0?(s-a)/a*100:0}},[w]),k=e=>e>=1e8?`${(e/1e8).toFixed(1)}億`:e>=1e4?`${Math.round(e/1e4).toLocaleString()}万`:e.toLocaleString();return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center bg-white p-6 rounded-lg shadow-sm border border-sf-border mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-sf-text",children:"売上分析"}),(0,s.jsx)("p",{className:"text-sm text-sf-text-weak mt-1",children:"全得意先の売上・粗利・前年比を分析します。"})]}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsx)("button",{onClick:g,className:"p-2 text-sf-light-blue hover:bg-blue-50 rounded-full transition-colors",title:"データを更新",children:(0,s.jsx)(c,{size:20})})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-sf-border shadow-sm",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"売上合計（今年）"}),(0,s.jsxs)("div",{className:"text-xl font-bold text-sf-text",children:[k(_.sales),"円"]}),(0,s.jsxs)("div",{className:`text-xs mt-1 ${_.salesYoY>=0?"text-green-600":"text-red-600"}`,children:["前年比 ",_.salesYoY>=0?"+":"",_.salesYoY.toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-sf-border shadow-sm",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"売上合計（前年）"}),(0,s.jsxs)("div",{className:"text-xl font-bold text-gray-500",children:[k(_.salesLastYear),"円"]}),(0,s.jsxs)("div",{className:"text-xs mt-1 text-gray-400",children:["差額 ",_.sales-_.salesLastYear>=0?"+":"",k(_.sales-_.salesLastYear),"円"]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-sf-border shadow-sm",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"粗利合計（今年）"}),(0,s.jsxs)("div",{className:"text-xl font-bold text-emerald-600",children:[k(_.profit),"円"]}),(0,s.jsxs)("div",{className:`text-xs mt-1 ${_.profitYoY>=0?"text-green-600":"text-red-600"}`,children:["前年比 ",_.profitYoY>=0?"+":"",_.profitYoY.toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-sf-border shadow-sm",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"粗利合計（前年）"}),(0,s.jsxs)("div",{className:"text-xl font-bold text-gray-500",children:[k(_.profitLastYear),"円"]}),(0,s.jsxs)("div",{className:"text-xs mt-1 text-gray-400",children:["差額 ",_.profit-_.profitLastYear>=0?"+":"",k(_.profit-_.profitLastYear),"円"]})]})]}),(0,s.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-sf-border shadow-sm flex flex-wrap items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative flex-1 min-w-[200px]",children:[(0,s.jsx)(n.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),(0,s.jsx)("input",{type:"text",placeholder:"得意先名、またはコードで検索...",value:o,onChange:e=>x(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-sf-border rounded focus:outline-none focus:ring-2 focus:ring-sf-light-blue/20 transition-all"})]}),(0,s.jsxs)("select",{value:p,onChange:e=>b(e.target.value),className:"border border-sf-border rounded px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-sf-light-blue/20",children:[(0,s.jsx)("option",{value:"all",children:"全ランク"}),v.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsxs)("select",{value:j,onChange:e=>y(e.target.value),className:"border border-sf-border rounded px-3 py-2 bg-white focus:outline-none focus:ring-2 focus:ring-sf-light-blue/20",disabled:0===N.length,children:[(0,s.jsx)("option",{value:"all",children:"全エリア"}),N.length>0?N.map(e=>(0,s.jsx)("option",{value:e,children:e},e)):(0,s.jsx)("option",{disabled:!0,children:"エリア情報なし"})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-500 whitespace-nowrap",children:[w.length," 件"]})]}),l?(0,s.jsx)("div",{className:"text-center py-20 text-gray-400",children:"データを読み込み中..."}):(0,s.jsx)(i,{data:w,sortField:m,sortDirection:h,onSort:e=>{m===e?f(e=>"asc"===e?"desc":"asc"):(u(e),f("desc"))}})]})}e.s(["default",()=>x],88754)}]);